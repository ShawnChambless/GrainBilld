var app=angular.module("personalProject");app.controller("mainCtrl",function(o,e,n,t,a,i){o.pageTitle=n.url(),o.showHopsBox=!1,o.showYeastBox=!1,o.showGrainInfo=!1,o.showHopsInfo=!1,o.showYeastInfo=!1,o.grainBoxToggle={rotate:!1},o.hopsBoxToggle={rotate:!1},o.yeastBoxToggle={rotate:!1};var s=[];o.batchSize||(o.batchSize=5),o.rotateGrain=function(){o.grainBoxToggle.rotate=!0,e(function(){o.grainBoxToggle.rotate=!1},255,!0)},o.rotateHops=function(){o.hopsBoxToggle.rotate=!0,e(function(){o.hopsBoxToggle.rotate=!1},255,!0)},o.rotateYeast=function(){o.yeastBoxToggle.rotate=!0,e(function(){o.yeastBoxToggle.rotate=!1},255,!0)};var c=function(){i.getGrainsInDb().then(function(e){o.grainsInDb=e.data,console.log("Got Grain In DB",e)})}(),h=function(){i.getHopsInDb().then(function(e){o.hopsInDb=e.data,console.log("Got Hops in DB",e)})}(),r=function(){i.getYeastInDb().then(function(e){o.yeastInDb=e.data,console.log("Got Yeast in DB",e)})}();o.showGrainFunction=function(){o.showGrainBox=!o.showGrainBox,o.showHopsBox=!1,o.showYeastBox=!1},o.showHopsFunction=function(){o.showHopsBox=!o.showHopsBox,o.showGrainBox=!1,o.showYeastBox=!1},o.showYeastFunction=function(){o.showYeastBox=!o.showYeastBox,o.showGrainBox=!1,o.showHopsBox=!1},o.addToGrainSearchText=function(e){o.grainSearchText=e.name},o.addToHopsSearchText=function(e){o.hopsSearchText=e.name},o.addToYeastSearchText=function(e){o.yeastSearchText=e.name};var p,g;o.addGrainToRecipe=function(e){o.OG||(o.OG=1),i.getGrainsInDb(e).then(function(e){i.grainInRecipe.push(e.data[0]),o.grainSearchText="",o.grainInRecipe=i.grainInRecipe,g?(p=parseFloat(g)+1e3*(parseFloat(e.data[0].sg)-1),g=p,console.log("item to add > 0",p,g)):(g=1e3*(e.data[0].sg-1),p=g,console.log("item to add === 0",p,g));var n=parseFloat(e.data[0].lovibond*o.grainWeight/o.batchSize);o.recipeSrm=.4922*Math.pow(n,.6859),o.OG=parseFloat(o.grainWeight*(e.data[0].extractPercent/100)*o.grainWeight*.75)/o.batchSize})};var l;o.addHopsToRecipe=function(e){i.getHopsInDb(e).then(function(e){i.hopsInRecipe.push(e.data[0]),console.log("Added Hops",e),o.hopsSearchText="",o.hopsInRecipe=i.hopsInRecipe,0===o.boilTime?l=0:o.boilTime>0&&o.boilTime<=9?l=.05:o.boilTime>9&&o.boilTime<=19?l=.12:o.boilTime>19&&o.boilTime<=29?l=.15:o.boilTime>29&&o.boilTime<=44?l=.19:o.boilTime>44&&o.boilTime<=59?l=.22:o.boilTime>59&&o.boilTime<=74?l=.24:o.boilTime>74&&(l=.27),o.IBU=o.hopWeight*l*(e.data[0].alphaAcid/100)*7489/(o.batchSize*(1+(o.batchSize-1.05)/.2))})},o.addYeastToRecipe=function(e){i.getYeastInDb(e).then(function(e){i.yeastInRecipe.push(e.data[0]),console.log("Added yeast",e),o.yeastSearchText="",o.yeastInRecipe=i.yeastInRecipe,o.FG=1+p*(1-parseFloat(o.yeastInRecipe[0].maximumAttenuation)/100)/1e3,o.ABV=76.08*(o.OG-o.FG/1.775)-o.OG*(o.FG/.794),console.log(o.yeastInRecipe[0].maximumAttenuation,o.FG)})},o.toggleGrainInfo=function(){o.showGrainInfo=!o.showGrainInfo,o.showHopsInfo=!1,o.showYeastInfo=!1},o.toggleHopsInfo=function(){o.showHopsInfo=!o.showHopsInfo,o.showGrainInfo=!1,o.showYeastInfo=!1},o.toggleYeastInfo=function(){o.showYeastInfo=!o.showYeastInfo,o.showGrainInfo=!1,o.showHopsInfo=!1}});